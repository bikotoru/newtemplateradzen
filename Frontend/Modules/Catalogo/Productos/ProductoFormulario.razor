@page "/catalogo/producto/formulario"
@page "/catalogo/producto/formulario/{Id:guid}"
@using Frontend.Components.Base.Forms.PageWithCommandBar
@using Frontend.Components.Base
@using Frontend.Components.Validation
@using Shared.Models.Entities

<PageTitle>@(isEditMode ? $"Editar Producto - {entity.Nombre}" : "Nuevo Producto")</PageTitle>

<PageWithCommandBar BackPath="/catalogo/producto/list" 
                    ShowSave
                    OnSaveClick="@SaveForm">

    <div class="full-width-tabs">
        <CrmTabs DefaultTabId="tab1" DisableUrlSync="true">
            
            <CrmTab Id="tab1" Title="InformaciÃ³n General" Icon="edit" IconColor="#0078d4">
                <div class="scrollable-content">
                    <RadzenRow JustifyContent="JustifyContent.Center">
                        <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
                            
                            <EssentialsCard Title="@(isEditMode ? "Editar Producto" : "Nuevo Producto")" 
                                           Icon="@(isEditMode ? "edit" : "add")" 
                                           IconColor="#0078d4"
                                           ShowEssentials=@(entity.Id != Guid.Empty)>
                             
                                <EssentialsTemplate>
                                    <EssentialsGrid>
                                        <EssentialsItem Label="Estado" Value="@(entity.Active ? "Activo" : "Inactivo")" />
                                        <EssentialsItem Label="Creado" Value="@(entity.FechaCreacion.ToString("dd/MM/yyyy"))" />
                                        <EssentialsItem Label="ID" Value="@entity.Id.ToString()" />
                                    </EssentialsGrid>
                                </EssentialsTemplate>
                                
                                <ChildContent>
                                    <FormValidator Entity="entity" Rules="@GetValidationRules()">
                                        
                                        <RadzenStack Gap="1rem">
                                            <ValidatedInput FieldName="Nombre" Value="@entity.Nombre">
                                                <RadzenFormField Text="Nombre" Style="width: 100%">
                                                    <RadzenTextBox @oninput="@(v => entity.Nombre = v.Value?.ToString())" 
                                                                   Value="@entity.Nombre"
                                                                   Placeholder="Ingrese nombre" />
                                                </RadzenFormField>
                                            </ValidatedInput>
                                            <ValidatedInput FieldName="Codigosku" Value="@entity.Codigosku">
                                                <RadzenFormField Text="Codigosku" Style="width: 100%">
                                                    <RadzenTextBox @oninput="@(v => entity.Codigosku = v.Value?.ToString())" 
                                                                   Value="@entity.Codigosku"
                                                                   Placeholder="Ingrese codigosku" />
                                                </RadzenFormField>
                                            </ValidatedInput>
                                            <ValidatedInput FieldName="Precioventa" Value="@entity.Precioventa">
                                                <RadzenFormField Text="Precioventa" Style="width: 100%">
                                                    <RadzenNumeric @bind-Value="entity.Precioventa" 
                                                                   Placeholder="0"
                                                                   
                                                                   ShowUpDown="false" />
                                                </RadzenFormField>
                                            </ValidatedInput>
                                            <ValidatedInput FieldName="Preciocompra" Value="@entity.Preciocompra">
                                                <RadzenFormField Text="Preciocompra" Style="width: 100%">
                                                    <RadzenNumeric @bind-Value="entity.Preciocompra" 
                                                                   Placeholder="0"
                                                                   
                                                                   ShowUpDown="false" />
                                                </RadzenFormField>
                                            </ValidatedInput>
                                            <ValidatedInput FieldName="MarcaId" Value="@entity.MarcaId">
                                                <RadzenFormField Text="MarcaId" Style="width: 100%">
                                                    <Lookup TEntity="Marca" 
                                                           TValue="Guid?" 
                                                           @bind-Value="entity.MarcaId"
                                                           Service="MarcaService"
                                                           DisplayProperty="Nombre"
                                                           EntityDisplayName="Marca"
                                                           SearchableFields="@marcaSearchFields"
                                                           EnableCache="true" />
                                                </RadzenFormField>
                                            </ValidatedInput>
                                            <ValidatedInput FieldName="CategoriaId" Value="@entity.CategoriaId">
                                                <RadzenFormField Text="CategoriaId" Style="width: 100%">
                                                    <Lookup TEntity="Categoria" 
                                                           TValue="Guid?" 
                                                           @bind-Value="entity.CategoriaId"
                                                           Service="CategoriaService"
                                                           DisplayProperty="Nombre"
                                                           EntityDisplayName="Categoria"
                                                           SearchableFields="@categoriaSearchFields"
                                                           EnableCache="true" />
                                                </RadzenFormField>
                                            </ValidatedInput>
                                            
                                        </RadzenStack>
                                        
                                    </FormValidator>
                                </ChildContent>
                            </EssentialsCard>
                            
                        </RadzenColumn>
                    </RadzenRow>
                </div>
            </CrmTab>
            
        </CrmTabs>
    </div>

</PageWithCommandBar>