@page "/demo/form"
@using Frontend.Components.Base.Forms.PageWithCommandBar
@using Frontend.Components.Base
@using Shared.Models.Entities

<PageTitle>Demo Formulario</PageTitle>

<PageWithCommandBar BackPath="/demo/list" 
                    ShowSave="true"
                    OnSaveClick="@SaveForm">

    <div class="full-width-tabs">
        <CrmTabs DefaultTabId="tab1" DisableUrlSync="true">
            
            <CrmTab Id="tab1" Title="En Desarrollo" Icon="build" IconColor="#FF8C00">
                <div class="scrollable-content">
                    <RadzenRow JustifyContent="JustifyContent.Center">
                        <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
                            <EssentialsCard Title="Información Básica" 
                                           Icon="info" 
                                           IconColor="#0078d4"
                                           ShowEssentials="true">
                                <EssentialsTemplate>
                                    <EssentialsGrid>
                                        <EssentialsItem Label="Estado" Value="Activo" />
                                        <EssentialsItem Label="Tipo" Value="Categoría" />
                                        <EssentialsItem Label="Creado" Value="Hoy" />
                                        <EssentialsItem Label="Módulo" Value="Demo" IsLink="true" />
                                    </EssentialsGrid>
                                </EssentialsTemplate>
                                
                                <ChildContent>
                                    <RadzenStack Gap="1rem">
                                        <RadzenFormField Text="Nombre">
                                            <RadzenTextBox @bind-Value="categoria.Nombre" Placeholder="Ingrese el nombre de la categoría" />
                                        </RadzenFormField>
                                        
                                        <RadzenFormField Text="Descripción">
                                            <RadzenTextArea @bind-Value="categoria.Descripcion" Placeholder="Ingrese la descripción" />
                                        </RadzenFormField>
                                        
                                        <RadzenFormField Text="Categoría Relacionada">
                                            <Lookup TEntity="Categoria" 
                                                   TValue="Guid?" 
                                                   @bind-Value="categoriaRelacionadaId"
                                                   Service="CategoriaService"
                                                   DisplayProperty="Nombre"
                                                   ValueProperty="Id"
                                                   EntityDisplayName="Categoría"
                                                   FastCreateComponentType="typeof(Fast)"
                                                   BaseQuery="@baseQueryFilter"
                                                   EnableCache="true"
                                                   CacheTTL="TimeSpan.FromMinutes(10)"
                                                   CacheKey="categorias_z"
                                                   SearchableFields="@categoriaSearchFields"
                                                   AutoHeight="true"
                                                   ModalWidth="500px"
                                                   ShowAdd="true"
                                                   ShowSearch="true"
                                                   Placeholder="Seleccione una categoría..." />
                                        </RadzenFormField>
                                    </RadzenStack>
                                </ChildContent>
                            </EssentialsCard>
                        </RadzenColumn>
                        <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
                            <EssentialsCard Title="Información Básica" 
                                           Icon="info" 
                                           IconColor="#0078d4"
                                           ShowEssentials="true">
                                <EssentialsTemplate>
                                    <EssentialsGrid>
                                        <EssentialsItem Label="Estado" Value="Activo" />
                                        <EssentialsItem Label="Tipo" Value="Categoría" />
                                        <EssentialsItem Label="Creado" Value="Hoy" />
                                        <EssentialsItem Label="Módulo" Value="Demo" IsLink="true" />
                                    </EssentialsGrid>
                                </EssentialsTemplate>
                                
                                <ChildContent>
                                    <RadzenStack Gap="1rem">
                                        <RadzenFormField Text="Nombre">
                                            <RadzenTextBox @bind-Value="categoria.Nombre" Placeholder="Ingrese el nombre de la categoría" />
                                        </RadzenFormField>
                                        
                                        <RadzenFormField Text="Descripción">
                                            <RadzenTextArea @bind-Value="categoria.Descripcion" Placeholder="Ingrese la descripción" />
                                        </RadzenFormField>
                                    </RadzenStack>
                                </ChildContent>
                            </EssentialsCard>
                        </RadzenColumn>
                        <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
                            <EssentialsCard Title="Información Básica" 
                                           Icon="info" 
                                           IconColor="#0078d4"
                                           ShowEssentials="true">
                                <EssentialsTemplate>
                                    <EssentialsGrid>
                                        <EssentialsItem Label="Estado" Value="Activo" />
                                        <EssentialsItem Label="Tipo" Value="Categoría" />
                                        <EssentialsItem Label="Creado" Value="Hoy" />
                                        <EssentialsItem Label="Módulo" Value="Demo" IsLink="true" />
                                    </EssentialsGrid>
                                </EssentialsTemplate>
                                
                                <ChildContent>
                                    <RadzenStack Gap="1rem">
                                        <RadzenFormField Text="Nombre">
                                            <RadzenTextBox @bind-Value="categoria.Nombre" Placeholder="Ingrese el nombre de la categoría" />
                                        </RadzenFormField>
                                        
                                        <RadzenFormField Text="Descripción">
                                            <RadzenTextArea @bind-Value="categoria.Descripcion" Placeholder="Ingrese la descripción" />
                                        </RadzenFormField>
                                    </RadzenStack>
                                </ChildContent>
                            </EssentialsCard>
                        </RadzenColumn>
                    </RadzenRow>
                </div>
            </CrmTab>

     @*        <CrmTab Id="tab2" Title="En Desarrollo" Icon="build" IconColor="#FF8C00">
                <div class="scrollable-content">
                    <RadzenRow JustifyContent="JustifyContent.Center">
                        <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
                            <EssentialsCard Title="Configuración" 
                                           Icon="settings"
                                           IconColor="#6b46c1">
                                <ChildContent>
                                    <RadzenStack Gap="1rem">
                                        <RadzenFormField Text="Fecha">
                                            <RadzenDatePicker TValue="DateTime?" />
                                        </RadzenFormField>
                                        
                                        <RadzenFormField Text="Estado">
                                            <RadzenDropDown TValue="string" Data="@(new List<string> { "Activo", "Inactivo", "Pendiente" })" 
                                                           Placeholder="Seleccione estado" />
                                        </RadzenFormField>
                                    </RadzenStack>
                                </ChildContent>
                            </EssentialsCard>
                        </RadzenColumn>
                    </RadzenRow>
                </div>
            </CrmTab>

            <CrmTab Id="tab3" Title="En Desarrollo" Icon="build" IconColor="#FF8C00">
                <div class="scrollable-content">
                    <RadzenRow JustifyContent="JustifyContent.Center">
                        <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
                            <EssentialsCard Title="Opciones Avanzadas" 
                                           Icon="tune"
                                           IconColor="#dc2626"
                                           ShowHeaderTemplate="true">
                                <HeaderTemplate>
                                    <RadzenBadge BadgeStyle="BadgeStyle.Warning" Text="Beta" />
                                </HeaderTemplate>
                                
                                <ChildContent>
                                    <RadzenStack Gap="1rem">
                                        <RadzenFormField Text="Prioridad">
                                            <RadzenDropDown TValue="string" Data="@(new List<string> { "Alta", "Media", "Baja" })" 
                                                           Placeholder="Seleccione prioridad" />
                                        </RadzenFormField>
                                        
                                        <RadzenFormField Text="Confirmación">
                                            <RadzenCheckBox TValue="bool" />
                                        </RadzenFormField>
                                    </RadzenStack>
                                </ChildContent>
                            </EssentialsCard>
                        </RadzenColumn>
                    </RadzenRow>
                </div>
            </CrmTab>
 *@
        </CrmTabs>
    </div>

    @if (!string.IsNullOrEmpty(mensaje))
    {
        <div class="alert alert-success">
            <strong>✅ @mensaje</strong>
        </div>
    }

    @if (!string.IsNullOrEmpty(errorMessage))
    {
        <div class="alert alert-error">
            <strong>❌ Error:</strong> @errorMessage
        </div>
    }

</PageWithCommandBar>

<style>
    .full-width-tabs {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .scrollable-content {
        flex: 1;
        overflow-y: auto;
        padding: 2rem 1rem;
    }


    .alert {
        padding: 12px;
        border-radius: 4px;
        margin: 1rem auto;
        max-width: 600px;
        text-align: center;
        position: fixed;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
    }

    .alert-success {
        background: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
    }

    .alert-error {
        background: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
    }

    @@media (max-width: 768px) {
        .scrollable-content {
            padding: 1rem;
        }
    }
</style>