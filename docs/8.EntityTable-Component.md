# 8. EntityTable - Componente Avanzado de Tablas de Datos

## Descripci√≥n

`EntityTable` es un componente avanzado basado en `RadzenDataGrid` que proporciona una soluci√≥n completa para mostrar y manipular datos de entidades con funcionalidades avanzadas como filtros personalizados, lookups para relaciones, exportaci√≥n a Excel, b√∫squeda inteligente y acciones personalizadas.

## Ubicaci√≥n
```
Frontend/Components/Base/Tables/
‚îú‚îÄ‚îÄ EntityTable.razor                    # Componente principal
‚îú‚îÄ‚îÄ EntityTable.razor.cs                 # Code-behind principal  
‚îú‚îÄ‚îÄ EntityTable.Models.cs                # Modelos y configuraciones
‚îú‚îÄ‚îÄ EntityTable.CustomFilters.cs         # Sistema de filtros custom
‚îú‚îÄ‚îÄ EntityTable.DataLoading.cs           # Carga de datos
‚îú‚îÄ‚îÄ EntityTable.Search.cs                # Funcionalidad de b√∫squeda
‚îú‚îÄ‚îÄ EntityTable.Excel.cs                 # Exportaci√≥n a Excel
‚îú‚îÄ‚îÄ EntityTable.Actions.cs               # Manejo de acciones
‚îú‚îÄ‚îÄ EntityTable.Views.cs                 # Sistema de vistas m√∫ltiples
‚îî‚îÄ‚îÄ EntityTable.Columns.cs               # Gesti√≥n de columnas
```

## Caracter√≠sticas Principales

- ‚úÖ **Filtros personalizados avanzados** con modal de filtro para cada tipo de dato
- ‚úÖ **Sistema FilterLookup** para relaciones con b√∫squeda multi-campo
- ‚úÖ **B√∫squeda inteligente** con campos configurables
- ‚úÖ **Exportaci√≥n a Excel** con columnas y formatos personalizados
- ‚úÖ **Acciones personalizadas** flexibles por fila
- ‚úÖ **Vistas m√∫ltiples** con filtros y columnas diferentes
- ‚úÖ **Configuraci√≥n de columnas** completa (ancho, orden, visibilidad)
- ‚úÖ **Auto-refresh** y refresh manual
- ‚úÖ **Paginaci√≥n avanzada** con tama√±os configurables
- ‚úÖ **Responsive** y adaptable a dispositivos m√≥viles
- ‚úÖ **Integraci√≥n perfecta** con BaseApiService

## Par√°metros Principales

### Configuraci√≥n B√°sica
```csharp
[Parameter] public BaseApiService<T>? ApiService { get; set; }           // Servicio de datos
[Parameter] public List<ColumnConfig<T>>? ColumnConfigs { get; set; }    // Configuraci√≥n de columnas
[Parameter] public RenderFragment? Columns { get; set; }                 // Columnas como template
[Parameter] public QueryBuilder<T>? BaseQuery { get; set; }              // Query base para filtrar datos
```

### B√∫squeda y Filtrado
```csharp
[Parameter] public bool ShowSearchBar { get; set; } = true;              // Mostrar barra de b√∫squeda
[Parameter] public string SearchPlaceholder { get; set; } = "Buscar..."; // Placeholder del buscador
[Parameter] public List<string>? SearchFields { get; set; }              // Campos donde buscar
[Parameter] public bool ShowSearchFieldsInput { get; set; } = false;     // Input para campos de b√∫squeda
```

### Paginaci√≥n
```csharp
[Parameter] public bool AllowPaging { get; set; } = true;                // Habilitar paginaci√≥n
[Parameter] public int PageSize { get; set; } = 20;                      // Elementos por p√°gina
[Parameter] public IEnumerable<int>? PageSizeOptions { get; set; }       // Opciones de tama√±o de p√°gina
[Parameter] public bool ShowPagingSummary { get; set; } = true;          // Mostrar resumen de paginaci√≥n
```

### Acciones
```csharp
[Parameter] public bool ShowActions { get; set; } = false;               // Mostrar columna de acciones
[Parameter] public bool ShowEditButton { get; set; } = true;             // Bot√≥n editar por defecto
[Parameter] public bool ShowDeleteButton { get; set; } = true;           // Bot√≥n eliminar por defecto
[Parameter] public RenderFragment<T>? CustomActions { get; set; }        // Acciones personalizadas
[Parameter] public EventCallback<T> OnEdit { get; set; }                 // Evento de edici√≥n
[Parameter] public EventCallback<T> OnDelete { get; set; }               // Evento de eliminaci√≥n
```

### Funcionalidades Adicionales
```csharp
[Parameter] public bool ShowExcelExport { get; set; } = false;           // Bot√≥n exportar Excel
[Parameter] public bool ShowRefreshButton { get; set; } = false;         // Bot√≥n de refresh
[Parameter] public bool ShowAutoRefresh { get; set; } = false;           // Auto-refresh configurable
[Parameter] public bool ShowColumnConfig { get; set; } = false;          // Configurador de columnas
```

## Configuraci√≥n de Columnas

### ColumnConfig B√°sico
```csharp
var columnConfigs = new List<ColumnConfig<Producto>>
{
    new ColumnConfig<Producto> 
    { 
        Property = "Codigo", 
        Title = "C√≥digo", 
        Width = "120px",
        Order = 1,
        Sortable = true,
        Filterable = true
    },
    new ColumnConfig<Producto> 
    { 
        Property = "Nombre", 
        Title = "Nombre del Producto", 
        Width = "250px",
        Order = 2,
        Sortable = true,
        Filterable = true
    },
    new ColumnConfig<Producto> 
    { 
        Property = "Precio", 
        Title = "Precio", 
        Width = "120px",
        TextAlign = TextAlign.Right,
        Order = 3,
        Sortable = true,
        Filterable = true
    }
};
```

### Propiedades de ColumnConfig
| Propiedad | Tipo | Descripci√≥n | Por Defecto |
|-----------|------|-------------|-------------|
| `Property` | `string` | Nombre de la propiedad de la entidad | **Requerido** |
| `Title` | `string` | T√≠tulo a mostrar en la cabecera | **Requerido** |
| `Width` | `string?` | Ancho de la columna ("120px", "15%") | `null` |
| `Sortable` | `bool` | Si permite ordenamiento | `true` |
| `Filterable` | `bool` | Si permite filtros personalizados | `true` |
| `TextAlign` | `TextAlign` | Alineaci√≥n del contenido | `TextAlign.Left` |
| `Frozen` | `bool` | Si la columna est√° congelada | `false` |
| `Visible` | `bool` | Si la columna es visible | `true` |
| `Order` | `int?` | Orden de la columna | `null` |
| `Template` | `RenderFragment<T>?` | Template personalizado para la celda | `null` |
| `FilterLookup` | `IFilterLookup?` | Configuraci√≥n de lookup para filtros | `null` |

### Columnas con Template Personalizado
```csharp
new ColumnConfig<Producto> 
{ 
    Property = "Active", 
    Title = "Estado",
    Width = "100px",
    Template = producto => __builder =>
    {
        <RadzenBadge BadgeStyle="@(producto.Active ? BadgeStyle.Success : BadgeStyle.Danger)"
                     Text="@(producto.Active ? "Activo" : "Inactivo")" />
    }
},
new ColumnConfig<Producto> 
{ 
    Property = "Precio", 
    Title = "Precio",
    Width = "120px", 
    TextAlign = TextAlign.Right,
    Template = producto => __builder =>
    {
        <span style="font-weight: bold; color: green;">
            @producto.Precio.ToString("C")
        </span>
    }
}
```

## Sistema de Filtros Personalizados

EntityTable incluye un sistema avanzado de filtros que se activa haciendo clic en el √≠cono de filtro (üîç) en cada columna.

### Tipos de Filtros Soportados

#### 1. Filtros de Texto (string)
**Operadores disponibles:**
- Contiene (por defecto)
- No contiene
- Igual a
- No es igual a
- Inicia con
- Termina con
- Es nulo / No es nulo
- Est√° vac√≠o / No est√° vac√≠o

#### 2. Filtros Num√©ricos (int, decimal, double, etc.)
**Operadores disponibles:**
- Igual a (por defecto)
- No es igual a
- Mayor que / Mayor que o igual
- Menor que / Menor que o igual
- Es nulo / No es nulo

#### 3. Filtros de Fecha (DateTime)
**Operadores disponibles:**
- Igual a (por defecto)
- No es igual a
- Mayor que (despu√©s de)
- Menor que (antes de)
- Mayor que o igual / Menor que o igual
- Es nulo / No es nulo

#### 4. Filtros Booleanos (bool)
**Operadores disponibles:**
- Igual a (con selector Verdadero/Falso)
- No es igual a
- Es nulo / No es nulo

## Sistema FilterLookup (Relaciones)

Para campos que representan relaciones (como `CategoriaId`, `ClienteId`), puedes configurar lookups avanzados que permiten buscar por m√∫ltiples campos y mostrar informaci√≥n rica.

### FilterLookup B√°sico
```csharp
new ColumnConfig<Producto> 
{
    Property = "CategoriaId",
    Title = "Categor√≠a",
    Filterable = true,
    FilterLookup = new FilterLookup<Categoria>
    {
        DisplayProperty = "Nombre",
        ValueProperty = "Id", 
        Service = categoriaService,
        SearchColumns = new[] { "Nombre" }
    }
}
```

### FilterLookup Avanzado con M√∫ltiples Columnas
```csharp
new ColumnConfig<Pedido> 
{
    Property = "ClienteId",
    Title = "Cliente",
    Filterable = true,
    FilterLookup = new FilterLookup<Cliente>
    {
        DisplayProperty = "Nombre",
        ValueProperty = "Id",
        Service = clienteService,
        DisplayColumns = new[]
        {
            new LookupColumnConfig 
            { 
                Property = "Nombre", 
                Title = "Nombre Cliente", 
                Width = "200px" 
            },
            new LookupColumnConfig 
            { 
                Property = "Rut", 
                Title = "RUT", 
                Width = "120px" 
            },
            new LookupColumnConfig 
            { 
                Property = "Email", 
                Title = "Email", 
                Width = "250px" 
            },
            new LookupColumnConfig 
            { 
                Property = "Telefono", 
                Title = "Tel√©fono", 
                Width = "140px" 
            }
        },
        SearchColumns = new[] { "Nombre", "Rut", "Email", "Telefono" },
        PageSize = 15
    }
}
```

### FilterLookup con Datos Est√°ticos
```csharp
new ColumnConfig<Usuario> 
{
    Property = "TipoUsuarioId",
    Title = "Tipo Usuario",
    FilterLookup = new FilterLookup<TipoUsuario>
    {
        DisplayProperty = "Descripcion",
        ValueProperty = "Id",
        StaticData = new List<TipoUsuario>
        {
            new TipoUsuario { Id = 1, Descripcion = "Administrador" },
            new TipoUsuario { Id = 2, Descripcion = "Usuario Normal" },
            new TipoUsuario { Id = 3, Descripcion = "Solo Lectura" }
        },
        SearchColumns = new[] { "Descripcion" }
    }
}
```

### FilterLookup con Funci√≥n Personalizada
```csharp
new ColumnConfig<Proyecto> 
{
    Property = "ResponsableId",
    Title = "Responsable", 
    FilterLookup = new FilterLookup<Usuario>
    {
        DisplayProperty = "NombreCompleto",
        ValueProperty = "Id",
        DataLoader = async (searchTerm, skip, take) =>
        {
            // Solo usuarios activos y del departamento correcto
            var query = usuarioService.Query()
                .Where(u => u.Active == true)
                .Where(u => u.DepartamentoId == currentDepartamentoId);
            
            if (!string.IsNullOrEmpty(searchTerm))
            {
                query = query.Search(searchTerm);
            }
            
            var result = await query.Skip(skip).Take(take).ToPagedResultAsync();
            return (result.Data, result.TotalCount);
        },
        SearchColumns = new[] { "Nombre", "Apellido", "Email" }
    }
}
```

### Propiedades de FilterLookup<T>
| Propiedad | Tipo | Descripci√≥n | Por Defecto |
|-----------|------|-------------|-------------|
| `DisplayProperty` | `string` | Propiedad principal a mostrar | "Nombre" |
| `ValueProperty` | `string` | Propiedad que contiene el valor | "Id" |
| `DisplayColumns` | `LookupColumnConfig[]` | Columnas a mostrar en el lookup | `[]` |
| `SearchColumns` | `string[]` | Columnas por las que se puede buscar | `[]` |
| `Service` | `BaseApiService<T>` | Servicio API para cargar datos | `null` |
| `StaticData` | `List<T>` | Datos est√°ticos (alternativa al Service) | `null` |
| `DataLoader` | `Func<...>` | Funci√≥n personalizada para cargar datos | `null` |
| `PageSize` | `int` | Tama√±o de p√°gina para el lookup | 20 |

## Uso B√°sico

### Tabla Simple
```razor
@page "/productos"
@using Frontend.Components.Base.Tables

<EntityTable T="Producto" ApiService="@productoService" />

@code {
    [Inject] private ProductoService productoService { get; set; } = null!;
}
```

### Tabla con Configuraci√≥n de Columnas
```razor
<EntityTable T="Producto" 
             ApiService="@productoService"
             ColumnConfigs="@columnConfigs"
             ShowSearchBar="true"
             ShowExcelExport="true" />

@code {
    private List<ColumnConfig<Producto>> columnConfigs = new()
    {
        new ColumnConfig<Producto> 
        { 
            Property = "Codigo", 
            Title = "C√≥digo", 
            Width = "120px" 
        },
        new ColumnConfig<Producto> 
        { 
            Property = "Nombre", 
            Title = "Nombre", 
            Width = "250px" 
        },
        new ColumnConfig<Producto> 
        { 
            Property = "Precio", 
            Title = "Precio", 
            Width = "120px",
            TextAlign = TextAlign.Right 
        }
    };
}
```

## B√∫squeda Inteligente

### Configuraci√≥n de B√∫squeda
```razor
<EntityTable T="Producto" 
             ApiService="@productoService"
             ShowSearchBar="true"
             SearchPlaceholder="Buscar productos..."
             SearchFields="@searchFields" />

@code {
    // Campos espec√≠ficos donde buscar
    private List<string> searchFields = new() { "Nombre", "Descripcion", "Codigo" };
}
```

### B√∫squeda con Campos Din√°micos
```razor
<EntityTable T="Producto" 
             ShowSearchFieldsInput="true"  @* Permite al usuario especificar campos *@
             SearchPlaceholder="Buscar productos..." />
```

## Acciones Personalizadas

### Acciones por Defecto
```razor
<EntityTable T="Producto" 
             ApiService="@productoService"
             ShowActions="true"
             ShowEditButton="true" 
             ShowDeleteButton="true"
             OnEdit="@HandleEdit"
             OnDelete="@HandleDelete" />

@code {
    private async Task HandleEdit(Producto producto)
    {
        await DialogService.OpenAsync<EditProductoDialog>("Editar Producto", 
            new Dictionary<string, object> { { "Producto", producto } });
    }

    private async Task HandleDelete(Producto producto)
    {
        var confirmed = await DialogService.Confirm($"¬øEliminar {producto.Nombre}?", "Confirmar");
        if (confirmed == true)
        {
            await productoService.DeleteAsync(producto.Id);
            StateHasChanged(); // La tabla se recargar√° autom√°ticamente
        }
    }
}
```

### Acciones Completamente Personalizadas
```razor
<EntityTable T="Producto" 
             ShowActions="true"
             CustomActions="@GetCustomActions" />

@code {
    private RenderFragment<Producto> GetCustomActions => producto => __builder =>
    {
        <RadzenButton Icon="visibility" 
                      Size="ButtonSize.Small"
                      ButtonStyle="ButtonStyle.Info" 
                      Click="@(() => VerDetalle(producto))"
                      title="Ver Detalle" 
                      Style="margin-right: 5px;" />
                      
        <RadzenButton Icon="content_copy" 
                      Size="ButtonSize.Small"
                      ButtonStyle="ButtonStyle.Secondary"
                      Click="@(() => ClonarProducto(producto))"
                      title="Clonar" 
                      Style="margin-right: 5px;" />
                      
        @if (producto.Active)
        {
            <RadzenButton Icon="toggle_off" 
                          Size="ButtonSize.Small"
                          ButtonStyle="ButtonStyle.Warning"
                          Click="@(() => ToggleActive(producto))"
                          title="Desactivar" />
        }
        else
        {
            <RadzenButton Icon="toggle_on" 
                          Size="ButtonSize.Small" 
                          ButtonStyle="ButtonStyle.Success"
                          Click="@(() => ToggleActive(producto))"
                          title="Activar" />
        }
    };

    private async Task VerDetalle(Producto producto) { /* Implementaci√≥n */ }
    private async Task ClonarProducto(Producto producto) { /* Implementaci√≥n */ }
    private async Task ToggleActive(Producto producto) { /* Implementaci√≥n */ }
}
```

### Acciones con SplitButton
```csharp
private RenderFragment<Producto> GetSplitActions => producto => __builder =>
{
    <RadzenSplitButton Click="@(async (item) => await HandleSplitAction(producto, item))"
                      ButtonStyle="ButtonStyle.Primary"
                      Size="ButtonSize.Small"
                      Text="Acciones"
                      Icon="more_vert">
        <ChildContent>
            <RadzenSplitButtonItem Text="Ver Detalle" Value="view" Icon="visibility" />
            <RadzenSplitButtonItem Text="Editar" Value="edit" Icon="edit" />
            <RadzenSplitButtonItem Text="Clonar" Value="clone" Icon="content_copy" />
            <RadzenSplitButtonItem Text="@(producto.Active ? "Desactivar" : "Activar")" 
                                   Value="toggle" 
                                   Icon="@(producto.Active ? "toggle_off" : "toggle_on")" />
            <RadzenSplitButtonItem Text="Eliminar" Value="delete" Icon="delete" />
        </ChildContent>
    </RadzenSplitButton>
};

private async Task HandleSplitAction(Producto producto, RadzenSplitButtonItem item)
{
    switch (item.Value)
    {
        case "view": await VerDetalle(producto); break;
        case "edit": await EditarProducto(producto); break;
        case "clone": await ClonarProducto(producto); break;
        case "toggle": await ToggleActive(producto); break;
        case "delete": await EliminarProducto(producto); break;
    }
}
```

## Exportaci√≥n a Excel

### Exportaci√≥n B√°sica
```razor
<EntityTable T="Producto" 
             ApiService="@productoService"
             ShowExcelExport="true"
             ExcelButtonText="Descargar Excel" />
```

### Exportaci√≥n con Configuraci√≥n Personalizada
```csharp
@code {
    private async Task ExportarPersonalizado()
    {
        var excelColumns = new List<ExcelColumnConfig>
        {
            new ExcelColumnConfig 
            { 
                PropertyPath = "Codigo", 
                DisplayName = "C√≥digo",
                Width = 15 
            },
            new ExcelColumnConfig 
            { 
                PropertyPath = "Nombre", 
                DisplayName = "Nombre del Producto",
                Width = 30 
            },
            new ExcelColumnConfig 
            { 
                PropertyPath = "Precio", 
                DisplayName = "Precio ($)",
                Width = 15,
                CustomFormat = "$#,##0.00"
            },
            new ExcelColumnConfig 
            { 
                PropertyPath = "FechaCreacion", 
                DisplayName = "Fecha de Creaci√≥n",
                Width = 20,
                CustomFormat = "dd/mm/yyyy"
            }
        };

        await entityTableRef.ExportToExcelAsync(excelColumns, "ProductosPersonalizado.xlsx");
    }
}
```

## Vistas M√∫ltiples

Configura diferentes vistas de la misma entidad con filtros y columnas espec√≠ficas.

```csharp
private List<ViewConfiguration<Producto>> viewConfigurations = new()
{
    new ViewConfiguration<Producto>(
        "Todos los Productos", 
        null,  // Sin filtro base
        GetAllColumnConfigs()
    ),
    
    new ViewConfiguration<Producto>(
        "Solo Activos", 
        productoService.Query().Where(p => p.Active == true), 
        GetActiveColumnConfigs()
    ),
    
    new ViewConfiguration<Producto>(
        "Categoria Electr√≥nicos",
        productoService.Query().Where(p => p.CategoriaId == electronicosId),
        GetElectronicosColumnConfigs()
    ),
    
    new ViewConfiguration<Producto>(
        "Con Stock Bajo",
        productoService.Query().Where(p => p.Stock < 10),
        GetStockBajoColumnConfigs()
    )
};
```

```razor
<EntityTable T="Producto" 
             ApiService="@productoService"
             ViewConfigurations="@viewConfigurations"
             CurrentViewIndex="0" />
```

## Auto-Refresh

### Configuraci√≥n de Auto-Refresh
```razor
<EntityTable T="Producto" 
             ShowAutoRefresh="true"
             AutoRefreshIntervals="@refreshIntervals" />

@code {
    private int[] refreshIntervals = { 5, 10, 30, 60 }; // segundos
}
```

## Configuraci√≥n Avanzada

### Tabla Completa con Todas las Funcionalidades
```razor
<EntityTable T="Producto" 
             @ref="productosTable"
             ApiService="@productoService"
             ColumnConfigs="@columnConfigs"
             
             @* B√∫squeda *@
             ShowSearchBar="true"
             SearchPlaceholder="Buscar por nombre, c√≥digo o descripci√≥n..."
             SearchFields="@searchFields"
             
             @* Funcionalidades *@
             ShowExcelExport="true" 
             ShowRefreshButton="true"
             ShowAutoRefresh="true"
             AutoRefreshIntervals="@refreshIntervals"
             ShowColumnConfig="true"
             
             @* Paginaci√≥n *@
             AllowPaging="true"
             PageSize="25"
             PageSizeOptions="@(new int[] { 10, 25, 50, 100 })"
             ShowPagingSummary="true"
             
             @* Acciones *@
             ShowActions="true"
             CustomActions="@GetActions"
             
             @* Configuraci√≥n de Grid *@
             AllowSorting="false"  @* Deshabilitado - usamos custom sorting *@
             AllowFiltering="false"  @* Deshabilitado - usamos custom filters *@
             AllowColumnResize="true"
             EmptyText="No se encontraron productos"
             Style="height: 600px;" />

@code {
    private EntityTable<Producto>? productosTable;
    private List<string> searchFields = new() { "Nombre", "Codigo", "Descripcion" };
    private int[] refreshIntervals = { 10, 30, 60, 300 }; // 10s, 30s, 1m, 5m
    
    private List<ColumnConfig<Producto>> columnConfigs = new()
    {
        new ColumnConfig<Producto> 
        { 
            Property = "Codigo", 
            Title = "C√≥digo", 
            Width = "120px",
            Order = 1,
            Sortable = true,
            Filterable = true
        },
        new ColumnConfig<Producto> 
        { 
            Property = "Nombre", 
            Title = "Nombre del Producto", 
            Width = "250px",
            Order = 2,
            Sortable = true,
            Filterable = true
        },
        new ColumnConfig<Producto> 
        { 
            Property = "CategoriaId", 
            Title = "Categor√≠a", 
            Width = "150px",
            Order = 3,
            Sortable = false,
            Filterable = true,
            FilterLookup = new FilterLookup<Categoria>
            {
                DisplayProperty = "Nombre",
                ValueProperty = "Id",
                Service = categoriaService,
                SearchColumns = new[] { "Nombre" }
            }
        },
        new ColumnConfig<Producto> 
        { 
            Property = "Precio", 
            Title = "Precio", 
            Width = "120px",
            TextAlign = TextAlign.Right,
            Order = 4,
            Sortable = true,
            Filterable = true,
            Template = producto => __builder =>
            {
                <span style="font-weight: bold; color: #28a745;">
                    @producto.Precio.ToString("C")
                </span>
            }
        },
        new ColumnConfig<Producto> 
        { 
            Property = "Stock", 
            Title = "Stock", 
            Width = "100px",
            TextAlign = TextAlign.Center,
            Order = 5,
            Sortable = true,
            Filterable = true,
            Template = producto => __builder =>
            {
                var badgeStyle = producto.Stock > 10 ? BadgeStyle.Success :
                               producto.Stock > 0 ? BadgeStyle.Warning : BadgeStyle.Danger;
                var stockText = producto.Stock > 10 ? $"‚úì {producto.Stock}" : 
                              producto.Stock > 0 ? $"‚ö† {producto.Stock}" : "‚úó Agotado";
                <RadzenBadge BadgeStyle="@badgeStyle" Text="@stockText" />
            }
        },
        new ColumnConfig<Producto> 
        { 
            Property = "Active", 
            Title = "Estado", 
            Width = "100px",
            TextAlign = TextAlign.Center,
            Order = 6,
            Sortable = true,
            Filterable = true,
            Template = producto => __builder =>
            {
                <RadzenBadge BadgeStyle="@(producto.Active ? BadgeStyle.Success : BadgeStyle.Danger)"
                             Text="@(producto.Active ? "Activo" : "Inactivo")" />
            }
        }
    };
}
```

## M√©todos P√∫blicos

### Control Program√°tico
```csharp
// Referencia al componente
private EntityTable<Producto>? tableRef;

// Recargar datos
await tableRef.Reload();

// Ir a primera p√°gina
await tableRef.FirstPage();

// Exportar a Excel
await tableRef.ExportToExcelAsync();

// Obtener elementos seleccionados (si se habilita selecci√≥n)
var selected = tableRef.GetSelectedItems();

// Limpiar selecci√≥n
tableRef.ClearSelection();
```

## Eventos Disponibles

```csharp
[Parameter] public EventCallback<LoadDataArgs> OnLoadData { get; set; }           // Carga personalizada
[Parameter] public EventCallback<LoadDataArgs> OnAfterLoadData { get; set; }     // Post-carga
[Parameter] public EventCallback<T> OnEdit { get; set; }                         // Editar elemento
[Parameter] public EventCallback<T> OnDelete { get; set; }                       // Eliminar elemento
[Parameter] public EventCallback<T> OnRowClick { get; set; }                     // Click en fila
[Parameter] public EventCallback<T> OnRowDoubleClick { get; set; }               // Doble click en fila
[Parameter] public EventCallback<string> OnViewChanged { get; set; }             // Cambio de vista
```

## Casos de Uso Recomendados

### 1. Lista de Entidades CRUD
**Funcionalidades**: B√∫squeda, filtros, acciones de editar/eliminar, exportar
```razor
<EntityTable ShowSearchBar="true" 
             ShowActions="true" 
             ShowExcelExport="true" 
             OnEdit="@HandleEdit" 
             OnDelete="@HandleDelete" />
```

### 2. Dashboard con M√©tricas
**Funcionalidades**: Auto-refresh, vistas m√∫ltiples, templates personalizados
```razor
<EntityTable ShowAutoRefresh="true" 
             ViewConfigurations="@dashboardViews"
             AutoRefreshIntervals="@(new int[] {10, 30, 60})" />
```

### 3. Selector de Registros
**Funcionalidades**: Selecci√≥n m√∫ltiple, b√∫squeda, filtros
```razor
<EntityTable AllowSelection="true"
             SelectionMode="Multiple"
             ShowSearchBar="true"
             OnSelectionChanged="@HandleSelectionChanged" />
```

### 4. Reporte con Filtros Avanzados
**Funcionalidades**: FilterLookup, filtros personalizados, exportaci√≥n
```razor
<EntityTable ColumnConfigs="@reportColumns"  @* Incluye FilterLookups *@
             ShowExcelExport="true"
             ShowColumnConfig="true" />
```

## Mejores Pr√°cticas

### ‚úÖ Configuraci√≥n de Columnas
- Siempre especifica `Width` para control preciso del layout
- Usa `Order` para controlar la secuencia de columnas  
- Configura `Sortable` y `Filterable` seg√∫n la necesidad de cada campo
- Utiliza `Templates` para mejorar la presentaci√≥n de datos

### ‚úÖ Filtros
- Usa `FilterLookup` para campos de relaci√≥n (Guid)
- Configura `SearchColumns` apropiadamente para b√∫squedas efectivas
- Considera datos est√°ticos para listas peque√±as y fijas
- Implementa funciones `DataLoader` personalizadas para l√≥gica compleja

### ‚úÖ Performance  
- Limita `PageSize` a valores razonables (10-50)
- Usa paginaci√≥n siempre para grandes conjuntos de datos
- Habilita cache en FilterLookups para datos que cambian poco
- Evita templates muy complejos que impacten el renderizado

### ‚úÖ UX/UI
- Proporciona placeholders descriptivos en b√∫squedas
- Implementa acciones contextuales relevantes
- Usa badges y colores para resaltar estados importantes
- Configura mensajes de estado apropiados (`EmptyText`)

### ‚ùå Errores Comunes
- No especificar `Service` en FilterLookup
- Olvidar configurar `SearchColumns` en lookups
- Usar templates excesivamente complejos
- PageSize muy altos (>100)
- No manejar casos de datos vac√≠os

## Arquitectura de Archivos

### Estructura Modular
Cada aspecto de EntityTable est√° separado en archivos espec√≠ficos para facilitar mantenimiento:

- **EntityTable.razor** - Template principal y configuraci√≥n
- **EntityTable.Models.cs** - Definiciones de tipos y configuraciones  
- **EntityTable.CustomFilters.cs** - L√≥gica de filtros personalizados
- **EntityTable.DataLoading.cs** - Carga y procesamiento de datos
- **EntityTable.Search.cs** - Funcionalidad de b√∫squeda
- **EntityTable.Excel.cs** - Exportaci√≥n a Excel
- **EntityTable.Actions.cs** - Manejo de acciones de usuario
- **EntityTable.Views.cs** - Sistema de vistas m√∫ltiples
- **EntityTable.Columns.cs** - Gesti√≥n y configuraci√≥n de columnas

### Integraci√≥n con BaseApiService
EntityTable se integra perfectamente con `BaseApiService`, aprovechando todas sus capacidades:
- Queries tipadas con QueryBuilder
- B√∫squedas inteligentes
- Paginaci√≥n autom√°tica
- Cach√© y optimizaciones

## Troubleshooting

### Performance
- **Problema**: Tabla lenta al cargar
- **Soluci√≥n**: Reducir `PageSize`, optimizar queries, usar √≠ndices en BD

### Filtros
- **Problema**: FilterLookup no carga datos
- **Soluci√≥n**: Verificar que `Service` est√© configurado y `SearchColumns` sean v√°lidas

### B√∫squeda  
- **Problema**: No encuentra elementos existentes
- **Soluci√≥n**: Verificar `SearchFields`, asegurar que los campos existan en la entidad

### Exportaci√≥n
- **Problema**: Excel se descarga vac√≠o
- **Soluci√≥n**: Verificar permisos del FileDownloadService y configuraci√≥n de columnas

## Conclusi√≥n

EntityTable es una soluci√≥n completa y potente para la gesti√≥n de datos en aplicaciones Blazor que combina:

- **Funcionalidad avanzada** con filtros personalizados y lookups
- **Flexibilidad total** en configuraci√≥n de columnas y acciones
- **Performance optimizada** con paginaci√≥n y carga inteligente
- **UX superior** con b√∫squeda, exportaci√≥n y auto-refresh
- **Arquitectura modular** f√°cil de mantener y extender

Es ideal para cualquier escenario donde necesites mostrar y manipular datos de entidades, desde simples listados hasta dashboards complejos con filtros avanzados y m√∫ltiples acciones.