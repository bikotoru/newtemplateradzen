# 6. Diseño de Formularios con EssentialsCard

Esta guía explica cómo crear formularios siguiendo el patrón de diseño establecido en el proyecto, utilizando los componentes **EssentialsCard**, **EssentialsGrid**, **EssentialsItem** y **CrmTabs**.

## Estructura Base del Diseño

### 1. Layout Responsivo con RadzenRow/RadzenColumn

**Regla de diseño obligatoria:** Todos los formularios deben usar este patrón de columnas responsivas:

```razor
<RadzenRow JustifyContent="JustifyContent.Center">
    <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
        <!-- Contenido del formulario -->
    </RadzenColumn>
</RadzenRow>
```

**Explicación:**
- `SizeLG="4"`: En pantallas grandes (desktop), ocupa 4/12 = 33% del ancho
- `SizeMD="6"`: En pantallas medianas (tablet), ocupa 6/12 = 50% del ancho  
- `SizeSM="12"`: En pantallas pequeñas (móvil), ocupa 12/12 = 100% del ancho
- `JustifyContent.Center`: Centra el contenido horizontalmente

### 2. Estructura con Tabs

```razor
<PageWithCommandBar BackPath="/ruta/anterior" ShowSave="true" OnSaveClick="@SaveForm">
    <div class="full-width-tabs">
        <CrmTabs DefaultTabId="tab1" DisableUrlSync="true">
            <CrmTab Id="tab1" Title="General" Icon="edit" IconColor="#0078d4">
                <div class="scrollable-content">
                    <!-- Aquí va el contenido del formulario -->
                </div>
            </CrmTab>
        </CrmTabs>
    </div>
</PageWithCommandBar>
```

## EssentialsCard - Componente Principal

### Propiedades Principales

```razor
<EssentialsCard Title="Título de la Card"
                Icon="iconName" 
                IconColor="#ColorHex"
                ShowEssentials="true">
    
    <!-- Template para información esencial (opcional) -->
    <EssentialsTemplate>
        <EssentialsGrid>
            <!-- Items de información -->
        </EssentialsGrid>
    </EssentialsTemplate>
    
    <!-- Contenido principal del formulario -->
    <ChildContent>
        <!-- Campos del formulario -->
    </ChildContent>
    
</EssentialsCard>
```

### Iconos Comunes y Colores

| Propósito | Icon | IconColor |
|-----------|------|-----------|
| Información general | `info` | `#0078d4` |
| Configuración | `settings` | `#6b46c1` |
| Desarrollo/Beta | `build` | `#FF8C00` |
| Avanzado | `tune` | `#dc2626` |
| Edición | `edit` | `#0078d4` |

## EssentialsGrid y EssentialsItem

### EssentialsGrid
Contenedor que organiza los items de información esencial en una cuadrícula responsiva.

### EssentialsItem
Muestra información clave en formato etiqueta-valor.

```razor
<EssentialsGrid>
    <EssentialsItem Label="Estado" Value="Activo" />
    <EssentialsItem Label="Tipo" Value="Categoría" />
    <EssentialsItem Label="Creado" Value="@DateTime.Now.ToString("dd/MM/yyyy")" />
    <EssentialsItem Label="Módulo" Value="Demo" IsLink="true" />
</EssentialsGrid>
```

**Propiedades de EssentialsItem:**
- `Label`: Etiqueta descriptiva
- `Value`: Valor a mostrar
- `IsLink`: Si es `true`, el valor se muestra como enlace

## Ejemplo Completo - Formulario de Categoría

```razor
@page "/demo/form"
@using Frontend.Components.Base.Forms.PageWithCommandBar
@using Frontend.Components.Base

<PageTitle>Demo Formulario</PageTitle>

<PageWithCommandBar BackPath="/demo/list" 
                    ShowSave="true"
                    OnSaveClick="@SaveForm">

    <div class="full-width-tabs">
        <CrmTabs DefaultTabId="tab1" DisableUrlSync="true">
            
            <CrmTab Id="tab1" Title="Información General" Icon="edit" IconColor="#0078d4">
                <div class="scrollable-content">
                    <RadzenRow JustifyContent="JustifyContent.Center">
                        <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
                            
                            <EssentialsCard Title="Información Básica" 
                                           Icon="info" 
                                           IconColor="#0078d4"
                                           ShowEssentials="true">
                                
                                <!-- Información esencial en la parte superior -->
                                <EssentialsTemplate>
                                    <EssentialsGrid>
                                        <EssentialsItem Label="Estado" Value="Nueva" />
                                        <EssentialsItem Label="Tipo" Value="Categoría" />
                                        <EssentialsItem Label="Creado" Value="@DateTime.Now.ToString("dd/MM/yyyy")" />
                                        <EssentialsItem Label="Módulo" Value="Demo" IsLink="true" />
                                    </EssentialsGrid>
                                </EssentialsTemplate>
                                
                                <!-- Formulario principal -->
                                <ChildContent>
                                    <RadzenStack Gap="1rem">
                                        <RadzenFormField Text="Nombre">
                                            <RadzenTextBox @bind-Value="categoria.Nombre" 
                                                          Placeholder="Ingrese el nombre de la categoría" />
                                        </RadzenFormField>
                                        
                                        <RadzenFormField Text="Descripción">
                                            <RadzenTextArea @bind-Value="categoria.Descripcion" 
                                                           Placeholder="Ingrese la descripción" />
                                        </RadzenFormField>
                                    </RadzenStack>
                                </ChildContent>
                            </EssentialsCard>
                            
                        </RadzenColumn>
                    </RadzenRow>
                </div>
            </CrmTab>
            
        </CrmTabs>
    </div>

</PageWithCommandBar>

<style>
    .full-width-tabs {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .scrollable-content {
        flex: 1;
        overflow-y: auto;
        padding: 2rem 1rem;
    }
</style>
```

## Patrones de CSS Obligatorios

### 1. CSS para Tabs Completos
```css
.full-width-tabs {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.scrollable-content {
    flex: 1;
    overflow-y: auto;
    padding: 2rem 1rem;
}
```

### 2. CSS para Alertas (opcional)
```css
.alert {
    padding: 12px;
    border-radius: 4px;
    margin: 1rem auto;
    max-width: 600px;
    text-align: center;
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1000;
}

.alert-success {
    background: #d4edda;
    border: 1px solid #c3e6cb;
    color: #155724;
}

.alert-error {
    background: #f8d7da;
    border: 1px solid #f5c6cb;
    color: #721c24;
}
```

## Múltiples Columnas

Para formularios más complejos, puedes usar múltiples columnas:

```razor
<RadzenRow JustifyContent="JustifyContent.Center">
    <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
        <EssentialsCard Title="Información Básica" Icon="info" IconColor="#0078d4">
            <!-- Contenido -->
        </EssentialsCard>
    </RadzenColumn>
    
    <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
        <EssentialsCard Title="Configuración" Icon="settings" IconColor="#6b46c1">
            <!-- Contenido -->
        </EssentialsCard>
    </RadzenColumn>
    
    <RadzenColumn SizeLG="4" SizeMD="6" SizeSM="12">
        <EssentialsCard Title="Opciones Avanzadas" Icon="tune" IconColor="#dc2626">
            <!-- Contenido -->
        </EssentialsCard>
    </RadzenColumn>
</RadzenRow>
```

## Mejores Prácticas

1. **Siempre usar PageWithCommandBar** como contenedor principal
2. **Usar CrmTabs** para organizar contenido en pestañas
3. **Aplicar el patrón de columnas responsivas** obligatorio
4. **Usar EssentialsCard** para agrupar campos relacionados
5. **Incluir EssentialsTemplate** con información contextual cuando sea útil
6. **Usar RadzenFormField** para etiquetas consistentes
7. **Aplicar RadzenStack** con `Gap="1rem"` para espaciado uniforme
8. **Implementar CSS para full-width-tabs y scrollable-content**

## Code-Behind (.cs)

```csharp
using Microsoft.AspNetCore.Components;
using Frontend.Modules.Categoria;
using Shared.Models.Entities;
using Shared.Models.Requests;

namespace Frontend.Pages.Demo;

public partial class Form : ComponentBase
{
    [Inject] private CategoriaService CategoriaService { get; set; } = null!;
    [Inject] private NavigationManager Navigation { get; set; } = null!;

    private Categoria categoria = new();
    private string mensaje = string.Empty;
    private string errorMessage = string.Empty;

    private async Task SaveForm()
    {
        try
        {
            mensaje = string.Empty;
            errorMessage = string.Empty;

            if (string.IsNullOrWhiteSpace(categoria.Nombre))
            {
                errorMessage = "El nombre es obligatorio";
                return;
            }

            var createRequest = new CreateRequest<Categoria>
            {
                Entity = categoria
            };

            var response = await CategoriaService.CreateAsync(createRequest);

            if (response.Success)
            {
                mensaje = "Categoría creada exitosamente";
                categoria = new Categoria();
                StateHasChanged();
            }
            else
            {
                errorMessage = response.Message ?? "Error al crear la categoría";
            }
        }
        catch (Exception ex)
        {
            errorMessage = $"Error inesperado: {ex.Message}";
        }
    }
}
```

Este patrón garantiza:
- **Diseño responsivo** que funciona en todos los dispositivos
- **Interfaz consistente** con el resto de la aplicación
- **Organización clara** del contenido en cards y tabs
- **Experiencia de usuario optimizada** con información contextual